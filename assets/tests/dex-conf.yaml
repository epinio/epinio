apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: dex-config
  namespace: epinio
stringData:
  config.yaml: |-
    issuer: "https://auth.%[1]s"
    storage:
      type: memory
    enablePasswordDB: true
    # TODO: Move the default Epinio users here
    staticPasswords:
    - email: "admin@epinio.io"
      # bcrypt hash of the string "password": $(echo password | htpasswd -BinC 10 admin | cut -d: -f2)
      hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"
      username: "admin"
      userID: "08a8684b-db88-4b73-90a9-3cd1661f5466"
    - email: "user1@epinio.io"
      hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"
      username: "user1"
      userID: "08a8684b-db88-4b73-90a9-3cd1661f5467"
    - email: "user2@epinio.io"
      hash: "$2a$10$2b2cU8CPhOTaGrs1HRQuAueS7JTT5ZHsHSzYiFPm1leZck7Mc8T4W"
      username: "user2"
      userID: "08a8684b-db88-4b73-90a9-3cd1661f5468"

    staticClients:
    # A "public" client for the cli and a non-public for the web UI
    - id: epinio-ui
      secret: %[2]s
      name: 'Epinio Web UI'
      redirectURIs:
      - "https://epinio.%[1]s/dex/callback"
    - id: epinio-cli
      public: true
      name: 'Epinio cli'
